pipeline {
	agent {
		label 'ubuntu2004'
	}

	stages {
		stage('Get the source') {
			steps {
				sh 'rm -rf riscv-gnu-toolchain'
				sh 'git clone https://github.com/riscv/riscv-gnu-toolchain'
				sh 'cd riscv-gnu-toolchain'
			}
		}

		stage('linux-rv64imafdc-lp64-medany on Ubuntu 20.04') {
			steps {
				sh 'cd regression && make build-linux-rv64imafdc-lp64-medany'
				sh 'cd regression && make check-linux-rv64imafdc-lp64-medany'
				sh 'cd regression && make report-linux-rv64imafdc-lp64-medany'
				sh 'cd regression && make check-binutils--linux-rv64imafdc-lp64-medany'
				sh 'cd regression && make report-binutils-linux-rv64imafdc-lp64-medany'
			}
		}
		stage('linux-rv64imafdc-lp64d-medany on Ubuntu 20.04') {
			steps {
				sh 'cd regression && make build-linux-rv64imafdc-lp64d-medany'
				sh 'cd regression && make check-linux-rv64imafdc-lp64d-medany'
				sh 'cd regression && make report-linux-rv64imafdc-lp64d-medany'
				sh 'cd regression && make check-binutils--linux-rv64imafdc-lp64d-medany'
				sh 'cd regression && make report-binutils-linux-rv64imafdc-lp64d-medany'
			}
		}

	}
}

